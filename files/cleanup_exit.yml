---

# Allows performing additional actions before testing exit code
# Assumes exitfile: $WORKSPACE/$ADEPT_CONTEXT.exit from previous node

- command:
    contexts:
        - setup
        - run
    filepath: /usr/bin/bash
    arguments: |
        -c 'set -ex;
            [ -r "$WORKSPACE/$ADEPT_CONTEXT.exit" ] || exit 1;
            RET=$(cat "$WORKSPACE/$ADEPT_CONTEXT.exit");
            rm -fv "$WORKSPACE/$ADEPT_CONTEXT.exit";
            [ -z "$RET" ] || exit $RET;
            exit 1;'
